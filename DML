import pandas as pd
import MySQLdb

mydb = MySQLdb.connect(
        host='localhost',
        user='aoludipe',
        db='aoludipe')

cursor = mydb.cursor()

# Preparing the data to be inserted into the Genes table
gene_data = pd.read_csv('Project_Data.csv', usecols=['Entry', 'Gene Names'])
gene_data = gene_data.rename(columns={'Entry': 'gene_id', 'Gene Names': 'gene_name'})
gene_data = gene_data.where((pd.notnull(gene_data)), None)

for i,row in gene_data.iterrows():
    sql = "INSERT INTO Genes (gene_id, gene_name) VALUES (%s, %s)"
    cursor.execute(sql, tuple(row))


# Preparing the data to be inserted into the Proteins table
protein_data = pd.read_csv('Project_Data.csv', usecols=['Entry', 'Protein names', 'Sequence'])
protein_data = protein_data.rename(columns={'Entry': 'gene_id', 'Protein names': 'protein_name', 'Sequence': 'protein_sequence'})
protein_data = protein_data.where((pd.notnull(protein_data)), None)

print(protein_data)

for i,row in protein_data.iterrows():
    sql = "INSERT INTO Proteins (gene_id, protein_name, protein_sequence) VALUES (%s, %s, %s)"
    cursor.execute(sql, tuple(row))

mydb.commit()
cursor.close()
print ("Done")
